/*! Copyright Research and Training Center on Community Living (RTC) at the University of Minnesota */
var Scenario=function(a){this.$container;this.nudgeDistance=0;this.init(a)};Scenario.prototype.init=function(d){this.$container=$(d).addClass("scenario-ui");$(".narrative",this.$container).height(this.$container.height());var e=parseInt($(".narrative",this.$container).eq(0).css("padding-right"));var c=parseInt($(".view-nudge",this.$container).css("padding-right"));var b=parseInt(this.$container.width())-(e*2)-c;$(".narrative, .responses",this.$container).width(b+"px");var a=$(".narrative",this.$container).eq(0).outerWidth();this.nudgeDistance=a-e+c;$(".view-nudge",this.$container).eq(0).width((a*2)+"px");if($(".responses .default-interaction",this.$container).length){$(".responses dd",this.$container).hide();if($(".responses dt a",this.$container).length==0){$(".responses dt",this.$container).wrapInner('<a href="#"></a>')}$(".responses",this.$container).on("click","a",$.proxy(this.responseHandler,this))}$(".narrative",this.$container).after($('<a href="#" class="view-toggle">Your <br>response:</a>').one("click",$.proxy(this.toggleToResponse,this)));$(".view-toggle",this.$container).css({top:(this.$container.height()/2)-($(".view-toggle",this.$container).outerHeight()/2),left:$(".responses",this.$container).position().left-($(".view-toggle",this.$container).outerWidth()/2)})};Scenario.prototype.toggleToResponse=function(c){c.preventDefault();var b=$(c.target);var a=$(".view-nudge",this.$container).animate({"margin-left":-this.nudgeDistance},600,$.proxy(function(){b.html("View <br>scenario");b.one("click",$.proxy(this.toggleToScenario,this))},this)).find(".responses").attr("data-directions");if(a){$(".scenario-instructions").html(a)}};Scenario.prototype.toggleToScenario=function(c){c.preventDefault();var b=$(c.target);var a=$(".view-nudge",this.$container).animate({"margin-left":0},600,$.proxy(function(){b.html("Your <br>response:");b.one("click",$.proxy(this.toggleToResponse,this))},this)).find(".narrative").attr("data-directions");if(a){$(".scenario-instructions").html(a)}};Scenario.prototype.responseHandler=function(b){b.preventDefault();var a=$(b.target);if($(".responses .response_selected",this.$container).length>0){$(".responses .response_selected",this.$container).each($.proxy(function(c,d){var e=$(d);e.parent().next("dd").slideUp(500,function(){e.removeClass("response_selected")})},this))}if(!a.hasClass("response_selected")){a.addClass("response_selected");a.parent().next("dd").slideDown(500)}};