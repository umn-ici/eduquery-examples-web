/*! Copyright College of Direct Support */
var MultipleChoice=(function(e){var h,d,a,f;var g=e('<div id="ansarea_select_hint" class="hidden"></div>');var c={showAll:false,transition_length:500,msg_correct:"Correct! - Answer the next question.",msg_fail:"Incorrect. Give it another try!",msg_win:"Congratulations, you've completed this exercise!"};var i={q_count:0,"$curGroup":""};var b={init:function(j){h=j.addClass("multiplechoice_ui");d=h.find("#mc_knowledgebank");a=h.find(".mc_kb_group");f=e("#message",h);f.addClass("msg_default");e("h3",a).each(function(k){var l=e(this);l.wrapInner('<span class="q_text">');l.attr("id","group"+k).prepend('<span class="q_num">'+(k+1)+"</span>")});e("li",a).each(function(k){var n=e(this);e(".answer_type",n).empty();var m=n.html();var l;if(n.hasClass("mc_item_correct")){l=e('<a href="" class="mc_ans_correct">'+m+"</a>")}else{l=e('<a href="">'+m+"</a>")}n.html(l)});a.each(function(k){var m=e(this);if(!c.showAll){if(k>0){m.addClass("inactive")}}m.data("questionData",{id:k,usePath:[]});var l=e(".feedback",m);if(l.length==1){m.data("questionData").feedback=l.text();l.detach()}});b.answersBind()},answersBind:function(){a.on("click.MultipleChoice","a",function(p){p.preventDefault();var j,l,o=false,n=e(this),k=n.closest("li"),m=i.$curGroup=n.closest(".mc_kb_group");if(k.hasClass("mc_item_correct")){k.addClass("indicator_correct");o=true}else{k.addClass("indicator_incorrect")}if(k.attr("data-feedback")){n.append('<span class="feedback"><span class="strong_meh">(</span>'+k.attr("data-feedback")+'<span class="strong_meh">)</span></span>')}m.data("questionData").usePath.push(n.text().replace(/^\s+|\s+$/g,""));n.parent().addClass("mc_answered");l=n.html();n.replaceWith('<span class="highlite">'+l+"</span>");if(o){i.q_count++;if(a.length==i.q_count){b.message("win")}else{b.message("correct")}}else{b.message("fail")}})},questionTransitionOut:function(){var j,l,k=i.$curGroup;k.animate({"padding-top":".3em","padding-bottom":".5em"},600);e(".q_text",k).animate({"font-size":".9em"},600);l=e(".mc_answered",k).not(".mc_item_correct");if(l.length>0){l.animate({"font-size":".8em"},600)}j=e("li",k).not(".mc_answered");if(j.length>0){j.hide(600,function(){b.questionComplete(k)})}else{b.questionComplete(k)}},questionComplete:function(k){var j,l;e("li",k).not(".mc_answered").remove();if(a.length==i.q_count){k.addClass("mc_knowledge")}else{j=k.data("questionData").id+1;l=a.eq(j);if(!c.showAll){window.setTimeout(function(){e(".q_text, ul",l).show(500,function(){l.removeClass("inactive");k.addClass("mc_knowledge")})},100)}else{l.removeClass("inactive");k.addClass("mc_knowledge")}}},message:function(n){var m="",k=true,l="",j=i.$curGroup.data("questionData").id;m=m+l;f.slideUp(200,function(){if(n=="correct"){f.removeClass("msg_fail").addClass("msg_correct");if(i.$curGroup.data("questionData").feedback){m=i.$curGroup.data("questionData").feedback}else{m=c.msg_correct}l=' <span class="hidden"><a href="#group'+(j+1)+'"></a></span>'}else{if(n=="fail"){f.removeClass("msg_correct").addClass("msg_fail");m=c.msg_fail;k=false;l=' <span class="hidden"><a href="#group'+j+'"></a></span>'}else{if(n=="win"){f.removeClass("msg_correct, msg_fail").addClass("msg_win");m=c.msg_win;d.parent().animate({"padding-top":"4.5em"},700)}else{if(n==""){f.removeClass().addClass("msg_default");f.empty();return}}}}e("h1",f).html(m);f.slideDown(500,function(){f.focus();if(k){b.questionTransitionOut()}})})},buildMessageFrom:function(){var j="";for(var k=0;k<arguments.length;k++){j+=arguments[k]}return j}};return{setMessage:function(k,j){if(k=="correct"){c.msg_correct=j}else{if(k=="fail"){c.msg_fail=j}else{if(k=="win"){c.msg_win=j}}}},init:function(j,k){if(k){e.extend(c,k)}b.init(j)}}})(jQuery);