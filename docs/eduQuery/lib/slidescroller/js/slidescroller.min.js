/*! All rights reserved Research and Training Center on Community Living (RTC) at the University of Minnesota (rtcweb@umn.edu) */
/*! Author : Shawn Lawler */
$.fn.slideScroller=function(a){var b={delimiter:"scrollerContainer",nextBtnTxt:"Next",prevBtnTxt:"Previous",animDuration:800,buttonAssistDuration:600,heightOfControlIcon:52,crossDomain:!0};a&&$.extend(b,a);var c={currentPanel:null,buttonIsHereTimer:null,scriptsDelay:null,enableNaviControls:!0};return this.length>1?this:this.each(function(){function l(d,e){var j,k,l,h=a.find(d),i=$('<div class="controls"></div>'),o=g.length,q=g.filter(d).data("dex");l=h.find(".controls").length>0?h.find(".controls"):i.clone(),q>=0&&o-1>q&&(j=m("forward",b.nextBtnTxt,"#"+g.eq(q+1).attr("id")),l.append(j)),q>0&&o-1>=q&&(k=m("reverse",b.prevBtnTxt,"#"+g.eq(q-1).attr("id")),l.prepend(k)),l.prepend('<a href="" class="visually_hidden skip-to-menu">Shortcut link to the full slide selection menu</a>'),h.append(l),h.find(".controls a:not(.jump a, .skip-to-menu)").one("click.slideScroller",p),h.find(".skip-to-menu").on("click.slideScroller",function(a){a.preventDefault();var b=$(this).closest(".panel").data("dex");$("#navi li a").eq(b).focus()}),h.find(".controls .jump, .controls .jump a").css("height",f+"px"),setTimeout(function(){h.find(".controls .forward, .controls .reverse").not(".jump").slideDown(400),c.enableNaviControls=!0,n(h.find(".controls .forward"))},600)}function m(a,b,c){return $('<div class="'+a+'" style="display:none;height:'+f+'px"><a href="'+c+'" style="height:'+f+'px" role="button"><span class="visually_hidden">'+b+"</span></a></div>")}function n(a){a.animate({opacity:"-=.75"},350),a.animate({opacity:"+=.75"},300,function(){c.buttonIsHereTimer=setTimeout(function(){n(a)},b.buttonAssistDuration)})}function o(a){var b="",c=$("#navi li.current");1==c.length&&(b=c.find(".note-for-at").detach(),c.removeClass("current")),b=""!=b?b:$('<span class="visually_hidden note-for-at"> this slide is currently displayed, press this button to skip to it&rsquo;s content.</span>');var d=g.filter(a).data("dex"),e=$("#navi li").eq(d);e.addClass("current"),e.find("a").append(b).hide().fadeIn(150)}function p(a){if("keydown"==a.type&&13!=a.which&&32!=a.which)return!0;a.preventDefault();var d=this.getAttribute("href");$(this).parent().hasClass("current")?$(d).focusWithoutScrolling(b.crossDomain):c.enableNaviControls&&(c.enableNaviControls=!1,q(d))}function q(d){var h,f=600;f||(f=0);var k,i=0,j=a.find(".panel");if(d=""!=d?d:"#p1",j.length>0){var m=parseInt(d.substring(d.search("p")+1)),n=j.data("dex")+1;m!=n?("number"==typeof c.scriptsDelay&&clearTimeout(c.scriptsDelay),clearTimeout(c.buttonIsHereTimer),m>n?(h="forward",i=1):n>m&&(h="reverse",i=-1),k=g.filter(d).clone(!0,!1),k.css("left",i*e+"px"),"forward"==h?a.append(k):"reverse"==h&&a.prepend(k),j.find(".controls .forward, .controls .reverse").not(".jump").remove(),j.animate({left:-1*i*e},f,function(){$(this).remove()}),k.animate({left:0},f,function(){c.scriptsDelay=setTimeout(function(){r(k),l(d,!1),c.scriptsDelay=null},f),o(d),b.crossDomain||window===window.parent&&(location.hash=d),k.focusWithoutScrolling(b.crossDomain)})):j.focusWithoutScrolling(b.crossDomain)}else h=null,k=g.filter(d).clone(!0,!1),k.css("opacity",.1),a.append(k),k.animate({opacity:1},f,function(){r(k),l(d,!0),o(d),b.crossDomain||window===window.parent&&(location.hash=d)})}function r(a){if(window.PSS&&"function"==typeof PSS.isScriptAtSlide){var b=a.data("dex");PSS.isScriptAtSlide(b)&&PSS.runScriptForSlide(b,a)}}function s(){e=a.width(),f=a.height()}var a=$(this),d=$(this).parent(),e=0,f=0,g=$(".panel",$(this)).clone();d.hasClass("not-cross-domain")&&(b.crossDomain=!1),$(".panel",$(this)).remove(),d.removeClass("default-view").addClass("scroller-view").attr({role:"region","aria-label":"Slide viewer interactive exercise. Please use the highest (beginner) verbosity setting in your screen reading software."}),s(!0);for(var h=$('<div id="orientingBar" role="region" aria-label="Slide selection menu (quick links to all slides):"><ul></ul></div>'),i=0,j=0,k=g.length;k>j;j++)g.eq(j).data("dex",j).attr({"aria-label":"Main content for this slide - you might encounter: text, images, audio-clip players, and embedded interactive exercises. A shortcut to the slide selection menu and slide-to-slide navigation is available at the bottom of each slide."}),i=j+1,$("ul",h).append('<li><a href="#p'+i+'" role="button"><span class="visually_hidden">Slide </span>'+i+"</a></li>");h.on("click.slideScroller, keydown.slideScroller","a",p),$("#navi").append(h),d.parent().get(0)===$("body").get(0)&&$(window).bind("resize.slideScroller",function(){s()}),q(location.hash)})},$.fn.focusWithoutScrolling=function(a){var b=a?$(window):$(window.top),c=b.scrollLeft(),d=b.scrollTop();this.focus(),b.scrollLeft(c),b.scrollTop(d)};